### 시나리오
1. ftp서버 내 동영상이 위치한 파일경로에 GetSFTP 프로세서 연결하여 영상 파일 가져오기
2. UpdateAttribute 프로세서 연결하여 메타데이터 추가
3. 메타데이터는 Kafka에, 영상파일은 SFTP에 저장

* * *
#### ⭕️ GetSFTP 프로세서 생성
   * Hostname - nifi가 설치되어있는 서버 ip주소 입력
   * Port - 22
   * Username
   * Password
   * RemotePath - 파일 가져올 경로 입력

 <img width="1437" alt="스크린샷 2023-08-23 오전 10 41 24" src="https://github.com/igikorea-chaeyeon-jung/sandox/assets/133837435/bb24a559-5a57-4ca9-aa8f-4ea40e44ad3a">

#### ⭕️ UpdateAttribute 프로세서 생성
   * (+) 버튼 클릭 후 attribute 추가, 본 예시에서는 filename(파일명), collect_time(수집시간), type(타입) 을 추가함

<img width="1435" alt="스크린샷 2023-08-23 오전 10 54 05" src="https://github.com/igikorea-chaeyeon-jung/sandox/assets/133837435/1ce2608b-20fa-4af4-8a3e-d75a50af39f2">

### AttributesToJson, PutFile 프로세서 생성
   * attribute 추가한 데이터의 파이프라인에서 메타데이터는 kafka에, 원본파일은 ftp서버에 저장하기 위해 두 갈래로 나눈다.
     
#### ⭕️ AttributesToJson 프로세서 생성
   * AttributesList - 이전에 추가했던 attribute들 중 json key값으로 만들 속성들 입력
   * Destination - flow-content
<img width="1429" alt="image" src="https://github.com/igikorea-chaeyeon-jung/sandox/assets/133837435/1d68a87b-ff18-449b-aa93-a54e6fde31d9">

#### ⭕️ PublishKafkafRecord_2_6 프로세서 생성
   * Kafka Brokers
   * Topic Name - 토픽 이름 입력
   * Record Reader - 하위 안내 참고
<img width="1437" alt="스크린샷 2023-08-23 오전 11 04 48" src="https://github.com/igikorea-chaeyeon-jung/sandox/assets/133837435/549e107e-e2ff-4fec-b406-c0cc28a3fb6d">      
   
   * Record Reader Value 빈칸 선택 -> Create new service 클릭

<br/>
<img width="1436" alt="스크린샷 2023-08-23 오전 11 04 58" src="https://github.com/igikorea-chaeyeon-jung/sandox/assets/133837435/10903728-35a7-4e64-963f-fb11d2ce6fdf">
   
   * Compatible Controller Services에서 JsonTreeReader 선택 -> 원하는 이름으로 변경(선택사항) -> Create로 생성

<br/>
   * Record Writer - 하위 안내 참고, Record Reader와 생성 방법 동일
<img width="1429" alt="스크린샷 2023-08-23 오전 11 05 30" src="https://github.com/igikorea-chaeyeon-jung/sandox/assets/133837435/ab6f7250-740b-4e1f-9995-7b7cf2d386d6">  
  
   * Record Writer Value 빈칸 선택 -> Create new service 클릭 -> Compatible Controller Services에서 JsonTreeReader 선택

<br/>
<img width="1428" alt="스크린샷 2023-08-23 오전 11 06 01" src="https://github.com/igikorea-chaeyeon-jung/sandox/assets/133837435/c3ded997-ba56-4794-9389-b3f6cb36b955">
   
   * Record Reader, Record Writer 각각 맨 오른쪽 -> 화살표 버튼 클릭

<br/>
<img width="1429" alt="스크린샷 2023-08-23 오전 11 06 09" src="https://github.com/igikorea-chaeyeon-jung/sandox/assets/133837435/4b25fa22-bf87-41b5-b950-1f743958441b">
   
   * 번개버튼 클릭하여 controller service 활성화

#### ⭕️ PutSFTP 프로세서 생성 (GetSFTP 프로세서 생성방식와 유사)
   * Hostname
   * Port
   * Username 
   * Password
   * Remote Path - 데이터가 저장될 경로 입력
   * Conflict Resolution - 파일명 같을 때 처리방식(IGNORE, RENAME, REPLACE 등)
<img width="1435" alt="스크린샷 2023-08-23 오후 2 10 23" src="https://github.com/igikorea-chaeyeon-jung/sandox/assets/133837435/05c78026-90af-43ea-896a-70183d3af594">

***

### 최종 파이프라인 구성 형태
<img width="1440" alt="스크린샷 2023-08-23 오후 2 11 29" src="https://github.com/igikorea-chaeyeon-jung/sandox/assets/133837435/0f976dc9-078f-4ca9-93de-26fefacb9d92">






   
